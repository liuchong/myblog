{"componentChunkName":"component---src-templates-blog-post-js","path":"/write-and-publish-blog-with-gatsby-and-github-workflow/","result":{"data":{"site":{"siteMetadata":{"title":"å¤§å¤§å¤§å¤§å¤§"}},"markdownRemark":{"id":"d9a02f9d-f662-5976-9ead-86b32342932e","excerpt":"åˆšé‡æ–°æŠŠåœ¨ github ä¸Šçš„ private æ‰çš„åšå®¢çš„ä»“åº“æ”¾äº†å‡ºæ¥ã€‚ ä¹‹å‰ç”¨çš„ä¹Ÿæ˜¯ gatsbyï¼Œè‡ªå·±æ”¹å‡ºæ¥äº†ä¸€ä¸ª gatsby-starter-blog-typescriptã€‚\nç°åœ¨ä¸æƒ³å‡çº§é‚£ä¸ªå¹´ä¹…å¤±ä¿®çš„ typescript ç‰ˆæœ¬çš„ä»£ç äº†ï¼Œç›´æ¥æ¸…ç©ºé‡æ–°èµ°äº†ä¸€éæµç¨‹ï¼Œæ›´æ–°åˆ°æœ€æ–°ç‰ˆå®˜æ–¹åšå®¢æ¨¡æ¿ gatsbyâ€¦","html":"<p>åˆšé‡æ–°æŠŠåœ¨ github ä¸Šçš„ private æ‰çš„<a href=\"/\">åšå®¢</a>çš„<a href=\"https://github.com/liuchong/myblog\">ä»“åº“</a>æ”¾äº†å‡ºæ¥ã€‚</p>\n<p>ä¹‹å‰ç”¨çš„ä¹Ÿæ˜¯ <a href=\"https://www.gatsbyjs.com/\">gatsby</a>ï¼Œè‡ªå·±æ”¹å‡ºæ¥äº†ä¸€ä¸ª <a href=\"https://github.com/liuchong/gatsby-starter-blog-typescript\">gatsby-starter-blog-typescript</a>ã€‚\nç°åœ¨ä¸æƒ³å‡çº§é‚£ä¸ªå¹´ä¹…å¤±ä¿®çš„ typescript ç‰ˆæœ¬çš„ä»£ç äº†ï¼Œç›´æ¥æ¸…ç©ºé‡æ–°èµ°äº†ä¸€éæµç¨‹ï¼Œæ›´æ–°åˆ°æœ€æ–°ç‰ˆå®˜æ–¹åšå®¢æ¨¡æ¿ <a href=\"https://github.com/gatsbyjs/gatsby-starter-blog\">gatsby-starter-blog</a>ã€‚</p>\n<h3>å®‰è£… gatsby</h3>\n<p>è¯¦ç»†è¿‡ç¨‹å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ <a href=\"https://www.gatsbyjs.com/tutorial/\">https://www.gatsbyjs.com/tutorial/</a>ï¼Œæˆ‘è¿™é‡Œæœ‰å®Œæ•´çš„ç¯å¢ƒï¼Œåªéœ€è¦è¿è¡Œå‘½ä»¤ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install -g gatsby-cli\ngatsby new myblog https://github.com/gatsbyjs/gatsby-starter-blog</code></pre></div>\n<p>è¿è¡Œå®Œäº†ï¼ŒæŠŠä¸€äº›æ–‡ä»¶é‡Œé¢æŒ‰ç…§éœ€è¦æ”¹ä¸€ä¸‹å°±å¯ä»¥ä½¿ç”¨äº†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">content/assets/\nsrc/components/bio.js\ngatsby-config.js</code></pre></div>\n<p>é¢„è§ˆä¸€ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">gatsby develop</code></pre></div>\n<p>æ‰§è¡Œå®Œå‘½ä»¤æ‰“å¼€ <a href=\"http://localhost:8000/\">http://localhost:8000/</a> å¯ä»¥çœ‹åˆ°å‡ ä¸ªç¤ºèŒƒæ–‡ç« å·²ç»åœ¨é‚£é‡Œäº†ã€‚</p>\n<p>æˆ‘è¿˜åœ¨ <code class=\"language-text\">static</code> ç›®å½•æ”¾ç½®äº†ä¸€äº›æ–‡ä»¶ï¼Œå®ƒä»¬ä¼šè¢«åŸå°ä¸åŠ¨çš„å¤åˆ¶åˆ°ç½‘ç«™ç›®å½•ã€‚\næ¯”å¦‚ <code class=\"language-text\">CNAME</code> ç”¨æ¥åœ¨ github pages ç»‘å®šåŸŸåï¼Œåé¢ä¼šå‘å¸ƒåå°±å¯ä»¥ç”¨åˆ°ã€‚</p>\n<p>å®‰è£…å®Œåï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ª github ä»“åº“ï¼Œæˆ‘è¿™é‡Œå°±æ˜¯ <code class=\"language-text\">myblog</code>ï¼ŒæŠŠä»£ç æäº¤åæ¨åˆ°ä»“åº“é‡Œã€‚</p>\n<h3>å†™æ–‡ç« </h3>\n<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨ <code class=\"language-text\">content/blog/</code> æœ‰ä¸€äº›ç›®å½•ï¼Œé‡Œé¢åˆ†åˆ«æœ‰ä¸€ä¸ª index.mdï¼Œè¿™å°±æ˜¯æ–‡ç« äº†ã€‚æ¯”å¦‚æˆ‘ä»¬å‚è§‚ä¸€ä¸‹è¿™ä¸ª <code class=\"language-text\">hello-world</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">---\ntitle: Hello World\ndate: &quot;2015-05-01T22:12:03.284Z&quot;\ndescription: &quot;Hello World&quot;\n---\n\nThis is my first post on my new fake blog! How exciting!\n... æ­¤å¤„çœç•¥å¾ˆå¤šå­—</code></pre></div>\n<p>ç°åœ¨è¿™äº›å±•ç¤ºæ–‡ç« çš„ä»»åŠ¡å°±åœ†æ»¡å®Œæˆäº†ï¼Œæˆ‘ä»¬æ„¿æ„çš„è¯å¯ä»¥æŠŠå®ƒä»¬åˆ é™¤ã€‚ç„¶åæ¯”ç€å®ƒä»¬çš„æ ¼å¼ï¼Œæ‰“å¼€å’±å–œæ¬¢çš„ç¼–è¾‘å™¨ï¼Œå†™èµ·æ¥å§ï¼</p>\n<p>å®‰è£…ä¸€ä¸ªå·¥å…· <code class=\"language-text\">gh-pages</code> å°è¯•å‘å¸ƒä¸€ä¸‹ï¼Œè¿›è¡Œè§‚èµï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install --save gh-pages\nnpx gh-pages -b public -d public -r https://github.com/liuchong/myblog.git</code></pre></div>\n<p>ä¸Šé¢å‘½ä»¤ç”¨ gh-pages å·¥å…·æŠŠ public ç›®å½•å‘åˆ°äº† public åˆ†æ”¯ï¼Œæ›´è¯¦ç»†å¯å‚è€ƒ <a href=\"https://www.gatsbyjs.com/docs/how-gatsby-works-with-github-pages/\">https://www.gatsbyjs.com/docs/how-gatsby-works-with-github-pages/</a>ã€‚\nåœ¨é¡¹ç›®è®¾ç½®é‡Œé¢è®¾ç½® github pages åˆ†æ”¯ï¼Œç‚¹å‡»æ˜¾ç¤ºå‡ºæ¥çš„é‚£ä¸ªé“¾æ¥åšå®¢å°±å‡ºæ¥äº†ã€‚</p>\n<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿˜ä¸é”™æ˜¯å§ï¼</p>\n<h3>è®¾ç½® workflow</h3>\n<p>ä½ çœ‹ï¼Œå†™å®Œæœ‰ä¸€æ­¥å‘å¸ƒè¿‡ç¨‹ï¼ŒæŒºéº»çƒ¦çš„ï¼›è€Œä¸”ä»€ä¹ˆæ—¶å€™æ²¡æœ‰ç¯å¢ƒæˆ–è€…ç”šè‡³åªæœ‰ä¸€ä¸ªæµè§ˆå™¨ï¼Œé‚£å°±å‘å¸ƒä¸äº†äº†ã€‚</p>\n<p>å¹¸äºæœ‰ github actionsï¼Œç”¨ä¸Šå®ƒå°±æ–¹ä¾¿å¤šäº†ã€‚</p>\n<p>æˆ‘ç›´æ¥æŠŠ workflow é…ç½®æ–‡ä»¶ <code class=\"language-text\">.github/workflows/publish.yml</code> è´´åˆ°è¿™é‡Œï¼Œå‡è®¾æºç æäº¤åˆ°äº† <code class=\"language-text\">master</code> åˆ†æ”¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">name: Publish\n\non:\n  push:\n    branches:\n      - master\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v1\n      - name: Publish\n        run: |\n          git config user.email ${{github.actor}}@users.noreply.github.com\n          git config user.name ${{github.actor}}\n          npm install\n          npx gatsby build\n          npx gh-pages -b public -d public -r https://${{ secrets.PUBLISH }}@github.com/${{ github.repository }}</code></pre></div>\n<p>è¦æ³¨æ„çš„æ˜¯ <code class=\"language-text\">secrets.PUBLISH</code> è¿™ä¸ªè¦æ‰‹åŠ¨åœ¨ <a href=\"https://github.com/settings/tokens\">https://github.com/settings/tokens</a> åˆ›å»º tokenï¼Œ\nç„¶åå†åˆ°é¡¹ç›®é‡Œé¢ï¼Œæ¯”å¦‚æˆ‘å°±æ˜¯åœ¨ <a href=\"https://github.com/liuchong/myblog/settings/secrets/actions\">https://github.com/liuchong/myblog/settings/secrets/actions</a>ï¼Œæ·»åŠ ä¸€ä¸ª secrets é¡¹ï¼Œ\n<code class=\"language-text\">Name</code>é‚£é¡¹å°±å¡«çš„ <code class=\"language-text\">PUBLISH</code>ã€‚</p>\n<p>è¯´æ˜ä¸€ä¸‹ï¼Œè¿™ä¸ªé“¾æ¥ <a href=\"https://docs.github.com/cn/free-pro-team@latest/actions/reference/authentication-in-a-workflow\">https://docs.github.com/cn/free-pro-team@latest/actions/reference/authentication-in-a-workflow</a> ä¸Šé¢è¿˜æœ‰ä¸ª <code class=\"language-text\">secrets.GITHUB_TOKEN</code>ï¼Œ\nè¯´æ˜¯è‡ªåŠ¨åˆ›å»ºçš„ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰ä½¿ç”¨æˆåŠŸã€‚</p>\n<p>å¦‚æœå‘å¸ƒæœ‰é—®é¢˜ï¼Œå¯ä»¥è¯•ç€æ‰‹åŠ¨æ‰§è¡Œä¸€ä¸‹å‘½ä»¤æµ‹è¯•ï¼Œæ³¨æ„ <code class=\"language-text\">***</code> æ”¹æˆè‡ªå·±çš„ secretï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">gh-pages -b public -d public -r https://***@github.com/liuchong/myblog.git</code></pre></div>\n<h3>ä»ç½‘é¡µå‘å¸ƒ</h3>\n<p>åˆ°ä»“åº“é¡µé¢ <a href=\"https://github.com/liuchong/myblog/tree/master/content/blog\">https://github.com/liuchong/myblog/tree/master/content/blog</a> ç‚¹å‡» <strong>Add file -> Create new file</strong> ç„¶åå¡«å…¥ <code class=\"language-text\">my-title/index.md</code>ï¼Œå†™å°±è¡Œäº†ã€‚</p>\n<p>æˆ‘è¿™ç¯‡åšå®¢å°±æ˜¯åœ¨ç½‘é¡µä¸Šé¢å†™çš„ï¼Œå…¶ä¸­ <code class=\"language-text\">date</code> æ¡ç›®æˆ‘æ‰‹å·¥å†™çš„ï¼Œæ‰€ä»¥ç®€åŒ–äº†ä¸€ä¸‹ï¼Œåƒ <code class=\"language-text\">date: &quot;2020-12-17&quot;</code> è¿™æ ·ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸ç”¨é‚£ä¹ˆç²¾ç¡®ã€‚</p>\n<p>ä¸è¿‡è¿˜æ˜¯ä¸æ¨èç›´æ¥åœ¨ç½‘é¡µä¸Šé¢å†™ï¼Œæˆ‘å†™å®Œåç‚¹å‡»äº†ä¸€ä¸‹ previewï¼Œåˆç‚¹å›ç¼–è¾‘ç•Œé¢æ—¶å¤±è´¥äº†ä¸€ä¸‹ï¼Œè¿˜ä»¥ä¸ºåšå®¢æ–‡ç« æ²¡äº†ï¼Œå“åäº† ğŸ‘€</p>","frontmatter":{"title":"ç”¨ gatsby å’Œ github workflow å†™åšå®¢","date":"December 17, 2020","description":"ç”¨ gatsby å’Œ github workflow å†™åšå®¢ï¼Œæ”¯æŒåœ¨åœ¨çº¿ç¼–è¾‘ï¼Œè‡ªåŠ¨å‘å¸ƒ"}},"previous":{"fields":{"slug":"/simple-snowflake-in-go-and-rust/"},"frontmatter":{"title":"simple snowflake in go and rust"}},"next":null},"pageContext":{"id":"d9a02f9d-f662-5976-9ead-86b32342932e","previousPostId":"f0d42108-fd27-54b0-8217-2712636629a4","nextPostId":null}},"staticQueryHashes":["2841359383","658381229"]}